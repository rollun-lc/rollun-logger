# Метрики

## Mysql

### Підключення

Щоб налаштувати запис метрик в базу, треба додати env змінну `METRIC_URL=http://health-checker/api/v1/MetricStore`. 

Всі необхідні конфіги вже існують в пакеті логеру, тому додаткових налаштувань робити не треба.

### Використання

Щоб записати метрику в базу, треба відправити через логер лог, який відповідає таким умовам:

1. level = `warning` or `notice`
2. message = `METRICS`
3. context формату
```json
{
  "metricId" : "metric_name",
  "value" : 100
}
```

Приклад:

```php
$logger->warning('METRICS', ['metricId' => 'metric_name', 'value' => 100]);
```

### Перегляд

Метрика буде збережена в базу metrics в таблицю з назвою, переданою в `metricId` (в попередньому прикладі таблиця буде називатися `metric_name`). Якщо таблиця не існувала до цього логу, то вона буде створена автоматично.

